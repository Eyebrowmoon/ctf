#!/usr/bin/python

from pwn import *

DEBUG = True

p = remote("52.175.158.46", 40002)

def r(msg):
  response = p.recvuntil(msg)
  if DEBUG:
    log.info(response)
  return response

d = 786371267256868999118226791934671205315942381150986466070164723227031898664334257986514607958014396659742789659745180035755905807112259812686141385646481697446041060233546143065802264778236705432713849318782420960476766245768337475745716577409218780642957154935327976274495058808457709162191385502989583584298322532338147655531771659852230593185887022112840245823694168205827337620426990472043723480651193332590489571039169692472422388655884384934764497429398937027316358806411813745377926837270574791829651761902279360958006452123650101174621683752236097013361048635294895579004953193958409816108280604444276196738084341927378841633504383394442222125990413892770367685056809007029019458707048303055165136101534256153916251246381554841517704856170342444913571075139635598477001610942749726961732215114102585279875654660138137238397756740151396746425597938957525033628113828428601322744283293997103840456545784188964262520332748915486058572579027574203758452321200200373216514327769093664504521234057397214238879220680388074724638616611575836675352954104416318116931456503520212767846336440801243059723603766779422517269256457828355859295754463459192020190861049793438498156036107344590403562269201499186829451114717537083260213039225

pubkey = 65537

r("Data : ")
encrypted = int(r("\n"))

r("N : ")
N = int(r("\n"))

result = pow(encrypted, d, N)

p.sendline(str(result))

p.interactive()

p.close()
